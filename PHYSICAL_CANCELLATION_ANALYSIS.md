# –ê–Ω–∞–ª–∏–∑ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –æ—Ç–º–µ–Ω—ã –∑–∞–¥–∞—á –≤ BlockingTaskCancellationExample

## üéØ **–û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å**

**–ù–µ—Ç, –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –Ω–µ —Å–æ–≤—Å–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ.** –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä –¥–µ—Ç–∞–ª—å–Ω–æ:

## üìã **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞**

### **Example 1: Cancel Method - ‚ùå –ù–ï —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –æ—Ç–º–µ–Ω–∞**
```java
// –û—Ç–º–µ–Ω—è–µ–º –∑–∞–¥–∞—á—É
task.cancel();
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `isCancelled = true`
- –ó–∞–¥–∞—á–∞ **–ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è** –∏ —Å–∞–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —ç—Ç–æ—Ç —Ñ–ª–∞–≥
- –≠—Ç–æ **–∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ—Ç–º–µ–Ω–∞** - –∑–∞–¥–∞—á–∞ –¥–æ–ª–∂–Ω–∞ "—Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è" –Ω–∞ –æ—Ç–º–µ–Ω—É

**–ò–∑ –ª–æ–≥–æ–≤ –≤–∏–¥–Ω–æ:**
```
Task cancelled during data processing (iteration 5)
Task cancelled during interruption processing
```
–ó–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å **—Å–∞–º–∞**, —É–≤–∏–¥–µ–≤ —Ñ–ª–∞–≥ –æ—Ç–º–µ–Ω—ã.

### **Example 2: Stop Method - ‚ùå –ù–ï —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –æ—Ç–º–µ–Ω–∞**
```java
// –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ stop()
task.stop();
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `shouldStop = true`
- –í –æ—á–µ—Ä–µ–¥—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –º–∞—Ä–∫–µ—Ä `"STOP_MARKER"`
- –ó–∞–¥–∞—á–∞ **–ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è** –∏ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —ç—Ç–∏ —Å–∏–≥–Ω–∞–ª—ã

**–ò–∑ –ª–æ–≥–æ–≤ –≤–∏–¥–Ω–æ:**
```
Task stopped by stop flag (iteration 0)
Received stop marker from queue
```
–ó–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å **—Å–∞–º–∞**, —É–≤–∏–¥–µ–≤ —Å–∏–≥–Ω–∞–ª—ã –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.

### **Example 3: Future Cancel - ‚úÖ –§–ò–ó–ò–ß–ï–°–ö–ê–Ø –æ—Ç–º–µ–Ω–∞**
```java
// –û—Ç–º–µ–Ω—è–µ–º —á–µ—Ä–µ–∑ Future
boolean cancelled = future.cancel(true); // true = interrupt if running
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- `future.cancel(true)` **—Ñ–∏–∑–∏—á–µ—Å–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –ø–æ—Ç–æ–∫** —á–µ—Ä–µ–∑ `Thread.interrupt()`
- –ü–æ—Ç–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç `InterruptedException` –∏ **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è**
- –≠—Ç–æ **—Å–∏—Å—Ç–µ–º–Ω–∞—è –æ—Ç–º–µ–Ω–∞** –Ω–∞ —É—Ä–æ–≤–Ω–µ JVM

**–ò–∑ –ª–æ–≥–æ–≤ –≤–∏–¥–Ω–æ:**
```
Thread interrupted during processing
java.lang.InterruptedException: sleep interrupted
```
–ü–æ—Ç–æ–∫ –±—ã–ª **—Ñ–∏–∑–∏—á–µ—Å–∫–∏ –ø—Ä–µ—Ä–≤–∞–Ω** —Å–∏—Å—Ç–µ–º–æ–π.

### **Example 4: Timeout Cancellation - ‚úÖ –§–ò–ó–ò–ß–ï–°–ö–ê–Ø –æ—Ç–º–µ–Ω–∞**
```java
// –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É
if (!future.isDone()) {
    future.cancel(true); // –§–∏–∑–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- `future.get(5, TimeUnit.SECONDS)` –∏—Å—Ç–µ–∫–∞–µ—Ç –ø–æ —Ç–∞–π–º–∞—É—Ç—É
- –ó–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `future.cancel(true)` –¥–ª—è **—Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è**
- –ü–æ—Ç–æ–∫ **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è**

### **Example 5: Combined Cancellation - ‚ùå –ù–ï —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –æ—Ç–º–µ–Ω–∞**
```java
// –û—Ç–º–µ–Ω—è–µ–º –≤—Å–µ –∑–∞–¥–∞—á–∏ –≤ –ø—É–ª–µ
task.cancel();
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ –º–µ—Ö–∞–Ω–∏–∑–º `cancel()` –∏–∑ Example 1
- –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ—Ç–º–µ–Ω–∞ —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥–∏

## üîç **–ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è**

### **–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ—Ç–º–µ–Ω–∞ (–ù–ï —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è):**
```java
// Example 1, 2, 5
task.cancel(); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–ª–∞–≥
task.stop();   // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–ª–∞–≥ + –º–∞—Ä–∫–µ—Ä
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è
- ‚ùå –¢—Ä–µ–±—É–µ—Ç "—Å–æ–≥–ª–∞—Å–∏—è" –∑–∞–¥–∞—á–∏
- ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å "–≥–ª—É—Ö–∏–º–∏" –±–ª–æ–∫–∏—Ä—É—é—â–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

### **–§–∏–∑–∏—á–µ—Å–∫–∞—è –æ—Ç–º–µ–Ω–∞:**
```java
// Example 3, 4
future.cancel(true); // Thread.interrupt()
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ –±–ª–æ–∫–∏—Ä—É—é—â–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- ‚ùå –ú–æ–∂–µ—Ç –±—ã—Ç—å "–≥—Ä—É–±–æ–π"
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ `InterruptedException`

## üìä **–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞**

| –ü—Ä–∏–º–µ—Ä | –¢–∏–ø –æ—Ç–º–µ–Ω—ã | –§–∏–∑–∏—á–µ—Å–∫–∞—è? | –ú–µ—Ö–∞–Ω–∏–∑–º | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |
|--------|------------|-------------|----------|--------------|
| Example 1 | –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è | ‚ùå | –§–ª–∞–≥ `isCancelled` | ‚úÖ –í—ã—Å–æ–∫–∞—è |
| Example 2 | –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è | ‚ùå | –§–ª–∞–≥ `shouldStop` + –º–∞—Ä–∫–µ—Ä | ‚úÖ –í—ã—Å–æ–∫–∞—è |
| Example 3 | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ | `Thread.interrupt()` | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è |
| Example 4 | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ | `Thread.interrupt()` | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è |
| Example 5 | –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è | ‚ùå | –§–ª–∞–≥ `isCancelled` | ‚úÖ –í—ã—Å–æ–∫–∞—è |

## üéØ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç**

**–§–∏–∑–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω—è—é—Ç –±–ª–æ–∫–∏—Ä—É—é—â—É—é –∑–∞–¥–∞—á—É —Ç–æ–ª—å–∫–æ:**
- ‚úÖ **Example 3: Future Cancel** - —á–µ—Ä–µ–∑ `future.cancel(true)`
- ‚úÖ **Example 4: Timeout Cancellation** - —á–µ—Ä–µ–∑ `future.cancel(true)` –ø–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞

**–û—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –æ—Ç–º–µ–Ω—É:**
- ‚ùå Example 1: Cancel Method - —Ç–æ–ª—å–∫–æ —Ñ–ª–∞–≥
- ‚ùå Example 2: Stop Method - —Ç–æ–ª—å–∫–æ —Ñ–ª–∞–≥ + –º–∞—Ä–∫–µ—Ä  
- ‚ùå Example 5: Combined Cancellation - —Ç–æ–ª—å–∫–æ —Ñ–ª–∞–≥

## üîß **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–≤–æ–¥—ã**

### **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –æ—Ç–º–µ–Ω—É:**
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã
- "–ì–ª—É—Ö–∏–µ" –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –æ—Ç–º–µ–Ω—É:**
- –û–±—ã—á–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç–∏

### **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
```java
// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –æ—Ç–º–µ–Ω—É
task.cancel();

// –ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫—É—é
if (!task.isCompleted()) {
    future.cancel(true);
}
```

## üöÄ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

**–§–∏–∑–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω—è—é—Ç –∑–∞–¥–∞—á–∏ —Ç–æ–ª—å–∫–æ 2 –∏–∑ 5 –ø—Ä–∏–º–µ—Ä–æ–≤:**
- Example 3: `future.cancel(true)` - –ø—Ä—è–º–∞—è —Å–∏—Å—Ç–µ–º–Ω–∞—è –æ—Ç–º–µ–Ω–∞
- Example 4: `future.cancel(true)` –ø–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞

**–û—Å—Ç–∞–ª—å–Ω—ã–µ 3 –ø—Ä–∏–º–µ—Ä–∞** –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –æ—Ç–º–µ–Ω—É —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥–∏ –∏ –º–∞—Ä–∫–µ—Ä—ã, —á—Ç–æ **–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ**, –Ω–æ **–º–µ–¥–ª–µ–Ω–Ω–µ–µ** –∏ **—Ç—Ä–µ–±—É–µ—Ç "—Å–æ–≥–ª–∞—Å–∏—è" –∑–∞–¥–∞—á–∏** –Ω–∞ –æ—Ç–º–µ–Ω—É. 